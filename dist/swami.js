define(["jquery","angular","es5-shim"],function(n,t){var e=["$http",function(e){function r(o){var a={},u={},f={},l={loadFrom:{}},s={model:Object,before:t.noop,success:t.noop,error:t.noop,"finally":t.noop};return s.http=function(a,u,f,l){var c=-1!=n.inArray(a,["post","put"]);c&&(u=u||{},n.extend(u,s.dataDefaults.apply(s,arguments))),l=l||o,config=s.configDefaults.apply(s,arguments),s.before!=t.noop&&s.before.apply(s,arguments),r.before!=t.noop&&r.before.apply(s,arguments);var i=c?e[a](l,u,config):e[a](l,config);return i.result=f||{},t.forEach(["success","error","finally"],function(n){s[n]!=t.noop&&i[n](s[n]),r[n]!=t.noop&&i[n](r[n])}),i},s.all=function(t){return n.isEmptyObject(u)||t?l.all&&!t?l.all.result:(l.all=s.http("get",{},u),l.all.success(function(t){s.transformData(t,"all"),n.extend(l.all.result,t),u=l.all.result}),l.all.result):u},s.first=function(n){n=n||u;for(var t in n)return t},s.create=function(t,e){var r=new s.model;return n.extend(r,t),e&&(f[e]=r),r},s.find=function(n){return u[n]?u[n]:f[n]?f[n]:null},s.loadFrom=function(e,r,o){var u=t.toJson([e,r]);if(l.loadFrom[u]&&!o)return l.loadFrom[u].result;var f=l.loadFrom[u]=s.http("get",r,s.create(),e);return f.success(function(e){var r=Object.keys(a);t.forEach(e,function(t,e){f.result[e]=-1==n.inArray(e,r)?t:a[e][1].create(t)})}),f.result},s.transformData=function(e){var r=Object.keys(a);t.forEach(e,function(e){t.forEach(e,function(e,o){-1!=n.inArray(o,r)&&t.forEach(e,function(n,t){e[t]=a[o][1].create(e[t],t)})})})},s.hasMany=function(n,t){a[n]=["hasMany",t]},s.hasOne=function(n,t){a[n]=["hasOne",t]},s.save=function(n,t){return s.http("post",n,{},t)},s.dataDefaults=function(){return{_token:n("input[name=_token]").val()}},s.configDefaults=function(){return{headers:{"X-Requested-With":"XMLHttpRequest"}}},s}return r.before=function(){n("body").addClass("wait")},r.success=t.noop,r.error=t.noop,r["finally"]=function(){n("body").removeClass("wait")},r}];return t.module("Swami",[]).factory("Swami",e)});
/*
//@ sourceMappingURL=swami.js.map
*/
