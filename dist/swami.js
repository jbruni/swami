define(["jquery","angular","es5-shim"],function(n,t){var e=["$http",function(e){function r(o){var a={},u={},s={},l={loadFrom:{}},f={pk:"id",model:Object,before:t.noop,success:t.noop,error:t.noop,"finally":t.noop};return f.http=function(a,u,s,l){var c=-1!=n.inArray(a,["post","put"]);c&&(u=u||{},n.extend(u,f.dataDefaults.apply(f,arguments))),l=l||o,config=f.configDefaults.apply(f,arguments),f.before!=t.noop&&f.before.apply(f,arguments),r.before!=t.noop&&r.before.apply(f,arguments);var i=c?e[a](l,u,config):e[a](l,config);return i.result=s||{},t.forEach(["success","error","finally"],function(n){f[n]!=t.noop&&i[n](f[n]),r[n]!=t.noop&&i[n](r[n])}),i},f.all=function(t){return n.isEmptyObject(u)||t?l.all&&!t?l.all.result:(l.all=f.http("get",{},u),l.all.success(function(t){f.transformData(t,"all"),n.extend(l.all.result,t),u=l.all.result}),l.all.result):u},f.first=function(n){n=n||u;for(var t in n)return t},f.create=function(t,e){var r=new f.model;return n.extend(r,t),e&&(s[e]=r),r},f.find=function(n){return u[n]?u[n]:s[n]?s[n]:null},f.loadFrom=function(e,r,o){var u=t.toJson([e,r]);if(l.loadFrom[u]&&!o)return l.loadFrom[u].result;var c=l.loadFrom[u]=f.http("get",r,f.create(),e);return c.success(function(e){var r=Object.keys(a);t.forEach(e,function(e,o){-1==n.inArray(o,r)?c.result[o]=e:"hasOne"==a[o][0]?c.result[o]=a[o][1].create(e,e[a[o][1].pk]):"hasMany"==a[o][0]&&(t.forEach(e,function(n,t){e[t]=a[o][1].create(e[t],t)}),c.result[o]=e)}),c.result[f.pk]&&(s[c.result[f.pk]]=c.result)}),c.result},f.transformData=function(e){var r=Object.keys(a);t.forEach(e,function(e){t.forEach(e,function(e,o){-1!=n.inArray(o,r)&&t.forEach(e,function(n,t){e[t]=a[o][1].create(e[t],t),a[o][1].some[t]=e[t]})})})},f.hasMany=function(n,t){a[n]=["hasMany",t]},f.hasOne=function(n,t){a[n]=["hasOne",t]},f.save=function(n,t){return f.http("post",n,{},t)},f.dataDefaults=function(){return{_token:n("input[name=_token]").val()}},f.configDefaults=function(){return{headers:{"X-Requested-With":"XMLHttpRequest"}}},f}return r.before=function(){n("body").addClass("wait")},r.success=t.noop,r.error=t.noop,r["finally"]=function(){n("body").removeClass("wait")},r}];return t.module("Swami",[]).factory("Swami",e)});
/*
//@ sourceMappingURL=swami.js.map
*/
