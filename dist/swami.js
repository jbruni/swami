define(["jquery","angular","es5-shim"],function(t,n){var e=["$http",function(e){function r(o){var a={},u={},s={},l=[],c=[],f={loadFrom:{}},i={pk:"id",model:Object,before:n.noop,success:n.noop,error:n.noop,"finally":n.noop};return i.http=function(a,u,s,l){var c=-1!=t.inArray(a,["post","put"]);c&&(u=u||{},t.extend(u,i.dataDefaults.apply(i,arguments))),l=l||o,config=i.configDefaults.apply(i,arguments),i.before!=n.noop&&i.before.apply(i,arguments),r.before!=n.noop&&r.before.apply(i,arguments);var f=c?e[a](l,u,config):e[a](l,config);return f.result=s||{},n.forEach(["success","error","finally"],function(t){i[t]!=n.noop&&f[t](i[t]),r[t]!=n.noop&&f[t](r[t])}),f},i.all=function(n){return t.isEmptyObject(u)||n?f.all&&!n?f.all.result:(f.all=i.http("get",{},u),f.all.success(function(n){i.transformData(n,"all"),t.extend(f.all.result,n),u=f.all.result}),f.all.result):u},i.where=function(e,r){var o=n.toJson(e),a=t.inArray(o,c),u={};return-1==a||r?(-1!=a&&(u=l[a].result),f=i.http("post",e,u),f.success(function(n){i.transformData(n,"where"),t.extend(f.result,n)}),c.push(o),l.push(f),f.result):l[a].result},i.first=function(t){t=t||u;for(var n in t)return n},i.create=function(n,e){var r=new i.model;return t.extend(r,n),e&&(s[e]=r),r},i.find=function(t){return u[t]?u[t]:s[t]?s[t]:null},i.loadFrom=function(e,r,o){var u=n.toJson([e,r]);if(f.loadFrom[u]&&!o)return f.loadFrom[u].result;var l=f.loadFrom[u]=i.http("get",r,i.create(),e);return l.success(function(e){var r=Object.keys(a);n.forEach(e,function(e,o){-1==t.inArray(o,r)?l.result[o]=e:"hasOne"==a[o][0]?l.result[o]=a[o][1].create(e,e[a[o][1].pk]):"hasMany"==a[o][0]&&(n.forEach(e,function(t,n){e[n]=a[o][1].create(e[n],n)}),l.result[o]=e)}),l.result[i.pk]&&(s[l.result[i.pk]]=l.result)}),l.result},i.transformData=function(e){var r=Object.keys(a);n.forEach(e,function(o,u){e[u]=i.create(o,o[i.pk]),n.forEach(o,function(e,o){-1!=t.inArray(o,r)&&n.forEach(e,function(t,n){e[n]=a[o][1].create(e[n],n),a[o][1].some[n]=e[n]})})})},i.hasMany=function(t,n){a[t]=["hasMany",n]},i.hasOne=function(t,n){a[t]=["hasOne",n]},i.save=function(t,n){return i.http("post",t,{},n)},i.dataDefaults=function(){return{_token:t("input[name=_token]").val()}},i.configDefaults=function(){return{headers:{"X-Requested-With":"XMLHttpRequest"}}},i.some=s,i}return r.before=function(){t("body").addClass("wait")},r.success=n.noop,r.error=n.noop,r["finally"]=function(){t("body").removeClass("wait")},r}];return n.module("Swami",[]).factory("Swami",e)});
/*
//@ sourceMappingURL=swami.js.map
*/
